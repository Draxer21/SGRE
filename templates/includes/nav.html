{# Global left sidebar for SGRE. Included at top of every page. #}
{% with current_app=request.resolver_match.app_name|default:'' %}
<nav class="sgre-sidebar" role="navigation" aria-label="Navegación principal">
  <div class="sgre-sidebar__brand">
    <a href="/" class="sgre-sidebar__brand-link">SGRE</a>
  </div>
  <div class="sgre-sidebar__links">
    <a class="sgre-sidebar__link {% if current_app == 'cuentas' %}is-active{% endif %}" href="{% url 'cuentas:panel' %}">Cuentas</a>
    <a class="sgre-sidebar__link {% if current_app == 'eventos' %}is-active{% endif %}" href="{% url 'eventos:panel' %}">Eventos</a>
    <a class="sgre-sidebar__link {% if current_app == 'reservas' %}is-active{% endif %}" href="{% url 'reservas:panel' %}">Reservas</a>
    <a class="sgre-sidebar__link {% if current_app == 'reportes' %}is-active{% endif %}" href="{% url 'reportes:panel' %}">Reportes</a>
    <a class="sgre-sidebar__link {% if current_app == 'notificaciones' %}is-active{% endif %}" href="{% url 'notificaciones:panel' %}">Notificaciones</a>
    <a class="sgre-sidebar__link" href="/admin/">Admin</a>
  </div>
</nav>
{% endwith %}

<style>
  :root { --sgre-sidebar-w: 240px; }
  .sgre-sidebar {
    position: fixed; inset: 0 auto 0 0; width: var(--sgre-sidebar-w); height: 100vh;
    background: #0f172a; color: #e5e7eb; border-right: 1px solid rgba(255,255,255,.08);
    display: flex; flex-direction: column; padding: 14px 12px; z-index: 1000;
  }
  .sgre-sidebar__brand { padding: 6px 8px 12px; border-bottom: 1px solid rgba(255,255,255,.06); margin-bottom: 8px; }
  .sgre-sidebar__brand-link { color: #38bdf8; font-weight: 800; text-decoration: none; letter-spacing: .2px; }
  .sgre-sidebar__links { display: flex; flex-direction: column; gap: 6px; padding: 8px 4px; }
  .sgre-sidebar__link {
    color: #cbd5e1; text-decoration: none; padding: 8px 10px; border-radius: 8px; display: block;
  }
  .sgre-sidebar__link:hover { background: rgba(148,163,184,.15); color: #fff; }
  .sgre-sidebar__link.is-active { background: rgba(56,189,248,.18); color: #fff; box-shadow: inset 0 0 0 1px rgba(56,189,248,.25); }

  /* Shift main content container used across apps */
  .app-shell { margin-left: var(--sgre-sidebar-w); }

  /* Mobile behavior: slide-in sidebar */
  @media (max-width: 960px){
    .sgre-sidebar { transform: translateX(-100%); transition: transform .25s ease; }
    .sgre-sidebar.is-open { transform: translateX(0); }
    .app-shell { margin-left: 0; }
    .sgre-sidebar__toggle { position: fixed; top: 10px; left: 10px; z-index: 1100; background: #0f172a; color: #e5e7eb; border: 1px solid rgba(255,255,255,.15); border-radius: 8px; padding: 6px 10px; }
  }
</style>

<script>
  (function(){
    try {
      var mq = window.matchMedia('(max-width: 960px)');
      if (!mq.matches) return; // toggle solo en móvil
      var btn = document.querySelector('.sgre-sidebar__toggle');
      if (!btn) {
        btn = document.createElement('button');
        btn.className = 'sgre-sidebar__toggle';
        btn.type = 'button';
        btn.textContent = 'Menú';
        document.body.appendChild(btn);
      }
      var nav = document.querySelector('.sgre-sidebar');
      btn.addEventListener('click', function(){ nav.classList.toggle('is-open'); });
    } catch (e) { /* noop */ }
  })();
</script>
